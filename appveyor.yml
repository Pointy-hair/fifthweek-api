version: 1.0.{build}
branches:
  only:
    - master
environment: 
  gitkey: 
    secure: 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
install: 
  - ps: $key = $env:gitkey #just the key contents, copied from notepad, into the environment variable on the UI 
  - ps: $fileContent = "-----BEGIN RSA PRIVATE KEY-----" + "`n" 
  - ps: for ($i = 0; $i -lt $key.Length / 64; $i++) { $min = [math]::min(64, $key.Length - ($i * 64)); $fileContent += $key.substring($i*64, $min) + "`n"; } 
  - ps: $fileContent += "-----END RSA PRIVATE KEY-----" + "`n" 
  - ps: Set-Content c:\users\appveyor\.ssh\id_rsa $fileContent
before_build:
  - nuget restore
after_test::
  - deployToGitHub
build_script:
  - SET DEPLOYMENT_TEMP="%APPVEYOR_BUILD_FOLDER%\dist"
  - msbuild.exe "%APPVEYOR_BUILD_FOLDER%\Fifthweek.sln" /t:Clean /p:Configuration=Release
  - msbuild.exe "%APPVEYOR_BUILD_FOLDER%\Fifthweek.sln" /t:Clean /p:Configuration=Debug
  - msbuild.exe "%APPVEYOR_BUILD_FOLDER%\Fifthweek.sln" /t:Build /p:Configuration=Release
  - msbuild.exe "%APPVEYOR_BUILD_FOLDER%\Fifthweek.Api\Fifthweek.Api.csproj" /nologo /verbosity:m /t:Build /t:pipelinePreDeployCopyAllFilesToOneFolder /p:_PackageTempDir="%DEPLOYMENT_TEMP%";AutoParameterizationWebConfigConnectionStrings=false;Configuration=Release /p:SolutionDir="%APPVEYOR_BUILD_FOLDER%\.\\"
